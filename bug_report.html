<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bug Report Form</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { max-width: 600px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="name"], input[type="email"], textarea, select {
            width: calc(100% - 12px);
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        textarea { resize: vertical; min-height: 100px; }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover { background-color: #0056b3; }
    </style>
</head>



<body>

    <form id="theForm" method="post">
        <h2>Report a Bug</h2>

        <label for="bugTitle">Bug Title:</label>
        <input type="text" id="bugTitle" name="bugTitle" required>

        <label for="description">Description:</label>
        <textarea id="description" name="description" required></textarea>

        <label for="stepsToReproduce">Steps to Reproduce:</label>
        <textarea id="stepsToReproduce" name="stepsToReproduce" placeholder="e.g., 1. Go to page X. 2. Click button Y. 3. Observe Z." required></textarea>

        <label for="expectedResult">Expected Result:</label>
        <textarea id="expectedResult" name="expectedResult"></textarea>

        <label for="actualResult">Actual Result:</label>
        <textarea id="actualResult" name="actualResult"></textarea>

        <label for="environment">Environment (Browser, OS):</label>
        <input type="text" id="environment" name="environment" required>

        <label for="priority">Priority:</label>
        <select id="priority" name="priority">
            <option value="low">Low</option>
            <option value="medium">Medium</option>
            <option value="high">High</option>
            <option value="critical">Critical</option>
        </select>

        <label for="reporterName">Your Name:</label>
        <input type="name" id="reporterName" name="reporterName">

        <label for="reporterEmail">Your Email (Optional):</label>
        <input type="email" id="reporterEmail" name="reporterEmail">

        <button type="submit">Submit Bug Report</button>
    </form>

<script>
    const theForm = document.getElementById("theForm");

    theForm.addEventListener('submit', async (event) => {
    console.log("Got submit request!")
    event.preventDefault(); // Prevent default form submission

    const formData = new FormData(theForm);
    const data = Object.fromEntries(formData.entries());

    const error_msg = "There was an error contacting the server. We apologize for the inconvenience. Please report your bug via email to: lenchner@us.ibm.com"
    try {
      //const response = await fetch('http://127.0.0.1:5000/api/submit-bug-report', { 
      const response = await fetch('http://72.167.224.212:8080/api/submit-bug-report', { 
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        const result = await response.json();
        console.log('Success:', result);
        alert("Thank you for submitting a bug report!")
        window.close()
        
      } else {
        console.error('Error:', response.statusText);
        alert(error_msg)
      }
    } catch (error) {
      console.error('Network error:', error);
      alert(error_msg)
    }
  });
</script>    

</body>
</html>